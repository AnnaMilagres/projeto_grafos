import pandas as pd
import networkx as nx
import matplotlib.pyplot as plt

# Carregar o arquivo CSV
df = pd.read_csv('pagamentos-publicidade-2017.csv', encoding='ISO-8859-1', delimiter=';')


# Limpar e converter a coluna ' Bruto PI ' para float
df[' Bruto PI '] = df[' Bruto PI '].str.replace('.', '', regex=False)  # Remove o ponto dos milhares
df[' Bruto PI '] = df[' Bruto PI '].str.replace(',', '.', regex=False)  # Substitui vírgula por ponto para decimal
df[' Bruto PI '] = df[' Bruto PI '].astype(float)  # Converte para float

# Criar um grafo vazio
G = nx.Graph()

# Preencher o grafo com os dados
for _, row in df.iterrows():
    agencia = row['Agencia']
    subcontratado = row['Subcontratado']
    valor_bruto_pi = row[' Bruto PI ']
    
    # Adicionar a aresta com o peso correspondente ao valor da campanha
    G.add_edge(agencia, subcontratado, weight=valor_bruto_pi)

# Desenhar o grafo
plt.figure(figsize=(12,12))
pos = nx.spring_layout(G, k=0.15)  # Layout para visualização
nx.draw(G, pos, with_labels=True, node_size=50, font_size=10)
plt.show()
